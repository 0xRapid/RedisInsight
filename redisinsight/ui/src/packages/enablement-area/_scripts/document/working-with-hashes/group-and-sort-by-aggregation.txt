// Aggregations are a way to process the results of a search query, group, sort and transform them - and extract analytic insights from them.
// Aggregations are represented as the following data processing pipeline:
// Filter -> Group (Reduce) -> Apply -> Sort -> Apply

// Perform a Group By & Sort By aggregation of your documents: display the number of permits by city and then sort the city alphabetically

FT.AGGREGATE "permits" "*"
 GROUPBY 1 @city REDUCE COUNT 0 AS nb_of_permits
 SORTBY 2 @city Asc

// See the "permits" index schema for reference

// FT.CREATE "permits"
//  ON HASH
//     PREFIX 1 "permit:"
//  SCHEMA
//     "permit_timestamp" NUMERIC SORTABLE
//     "address_street" AS street TEXT NOSTEM
//     "address_city" AS city TAG SORTABLE
//     "description" TEXT
//     "building_type" TEXT NOSTEM SORTABLE
//     "work_type" TAG SEPARATOR ";"
//     "construction_value" NUMERIC SORTABLE
//     "location" GEO
