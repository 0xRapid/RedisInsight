// Aggregations are a way to process the results of a search query, group, sort and transform them - and extract analytic insights from them.
// Aggregations are represented as the following data processing pipeline:
// Filter -> Group (Reduce) -> Apply -> Sort -> Apply

// Perform a Group By & Sort By aggregation of your documents: display the number of permits by city and then sort the city alphabetically

FT.AGGREGATE "schools" "*"
    GROUPBY 1 @city REDUCE COUNT 0 AS nb_of_schools
    SORTBY 2 @city Asc

// See the "schools" index schema for reference

// FT.CREATE schools
// on JSON
//   PREFIX 1 "school:"
// SCHEMA
//   $.name AS name TEXT NOSTEM SORTABLE
//   $.description AS description TEXT
//   $.school_type AS school_type TAG SEPARATOR ";"
//   $.class AS class TAG
//   $.address.street AS address TEXT NOSTEM
//   $.address.city AS city TAG
//   $.pupils AS pupils NUMERIC SORTABLE
//   $.location AS location GEO
//   $.status_log.[-1] as status TAG
